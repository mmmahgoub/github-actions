# This job only runs on a successful 'push' event to the 'main' branch
if: success() && github.event_name == 'push' && github.ref == 'refs/heads/main'

steps:
  - name: Checkout code
    uses: actions/checkout@v4

  - name: Log in to Docker Registry
    # This action uses secrets for authentication (you'll need to set these up)
    uses: docker/login-action@v3
    with:
      username: ${{ secrets.DOCKER_USERNAME }}
      password: ${{ secrets.DOCKER_PASSWORD }}

  - name: Build and push Docker image
    uses: docker/build-push-action@v5
    with:
      context: .
      push: true
      # Tags the image with 'latest' and the specific git SHA
      tags: ${{ secrets.DOCKER_USERNAME }}/examtopics-downloader:latest, ${{ secrets.DOCKER_USERNAME }}/examtopics-downloader:${{ github.sha }}

